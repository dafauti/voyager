{
  "global": {
    "email_list_alerts": [
      "sonu.dafauti@gmail.com"
    ],
    "hive_db": "dpp_canada",
    "hive_table": "dpp_data_quality_agg",
    "hive_table_combined": "dpp_data_quality_combined",
    "projectDeploymentDir": "/gmail_daci/apps/merch/assort/dpp-canada/release-0.1.0/dpp-canada-app",
    "ddl_script_path": "/hive/ddls/data_quality/dpp_data_quality_agg_ddl.hql",
    "ddl_script_path_combined": "/hive/ddls/data_quality/dpp_data_quality_combined_ddl.hql",
    "applicationUserName": "svcmapprdrw",
    "sourceJDBCURL": "'jdbc:hive2://lxhdpmasprdw001.gmail.com:2181,lxhdpmasprdw002.gmail.com:2181,lxhdpmasprdw003.gmail.com:2181/default;httpPath=cliservice;principal=hive/_HOST@gmail.COM;serviceDiscoveryMode=zooKeeper;ssl=true;transportMode=http;zooKeeperNamespace=HttpHive'",
    "hive_hdfs_path":"hdfs://CDPWSPRODHA/edx/canada/gmail/merch/data/datasets/assort/",
    "rona_query":"insert overwrite table dpp_canada.dpp_data_quality_agg partition(load_date,banner,dataset)\nselect\nfiscal_year,\nfiscal_month,\nallocation_value,\nrow_number() over (partition by banner,dataset,fiscal_year,fiscal_month order by load_date desc) as rank,\nload_date,\nbanner,\ndataset\nfrom\n(select fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'shrink' as dataset from dpp_canada.rna_src_shrink_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'mst' as dataset from dpp_canada.rna_src_mst_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'sta' as dataset from dpp_canada.rna_src_sta_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'mdf_by_item' as dataset from dpp_canada.rna_src_mdf_by_item_agg group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'mdf_by_suplier' as dataset from dpp_canada.rna_src_mdf_by_supplier_agg group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'web_pos' as dataset from dpp_canada.rna_src_web_pos_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'pos' as dataset from dpp_canada.rna_src_pos_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'lump_sum' as dataset from dpp_canada.rna_src_lump_sum_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'delivery_revenue' as dataset from dpp_canada.rna_src_delivery_revenue_agg group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'delivery_expense' as dataset from dpp_canada.rna_src_delivery_expense_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'cash_discount' as dataset from dpp_canada.rna_src_cash_discount_ing group by fiscal_year\nUNION ALL\nselect fiscal_year,0 as fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'rona' as banner,'marketing' as dataset from dpp_canada.rna_src_marketing_adhoc group by fiscal_year\nUNION ALL  \nselect fiscal_year,fiscal_month,sum(sales) as allocation_value,current_date as load_date,'rona' as banner,'sales' as dataset from dpp_canada.rna_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(sales_allocate) as allocation_value,current_date as load_date,'rona' as banner,'sales_allocate' as dataset from dpp_canada.rna_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(quantity) as allocation_value,current_date as load_date,'rona' as banner,'quantity' as dataset from dpp_canada.rna_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(cogs_allocate) as allocation_value,current_date as load_date,'rona' as banner,'cogs_allocate' as dataset from dpp_canada.rna_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(vat) as allocation_value,current_date as load_date,'rona' as banner,'vat' as dataset from dpp_canada.rna_src_sales_master group by fiscal_year,fiscal_month\n)a",
    "gmail_query":"insert overwrite table dpp_canada.dpp_data_quality_agg partition(load_date,banner,dataset)\nselect\nfiscal_year,\nfiscal_month,\nallocation_value,\nrow_number() over (partition by banner,dataset,fiscal_year,fiscal_month order by load_date desc) as rank,\nload_date,\nbanner,\ndataset\nfrom\n(\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'shrink' as dataset from dpp_canada.lca_src_shrink_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'non_vat_acmc' as dataset from dpp_canada.lca_src_non_vat_acmc_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'non_vat_acmc' as dataset from dpp_canada.lca_src_non_vat_acmc_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'postage' as dataset from dpp_canada.lca_src_postage_allocation_final_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'cash_discount' as dataset from dpp_canada.lca_src_cash_discount_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'rtm_defective' as dataset from dpp_canada.lca_src_rtm_defective_allowance_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,0 AS fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'mst' as dataset from dpp_canada.lca_src_mst_agg group by fiscal_year\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'delivery_revenue' as dataset from dpp_canada.lca_src_delivery_revenue_allocation_final_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(allocation_value) as allocation_value,current_date as load_date,'gmail' as banner,'delivery_expense' as dataset from dpp_canada.lca_src_delivery_expense_allocation_final_agg group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(fil_sal_amt) as allocation_value,current_date as load_date,'gmail' as banner,'sales' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(fil_cst_amt) as allocation_value,current_date as load_date,'gmail' as banner,'fil_cst_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(tot_clm_aon_amt) as allocation_value,current_date as load_date,'gmail' as banner,'tot_clm_aon_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(avg_invoice_cost) as allocation_value,current_date as load_date,'gmail' as banner,'avg_invoice_cost' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(tot_dc_rcv_aon_amt) as allocation_value,current_date as load_date,'gmail' as banner,'tot_dc_rcv_aon_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(tot_dc_shp_aon_amt) as allocation_value,current_date as load_date,'gmail' as banner,'tot_dc_shp_aon_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(tot_dc_frg_aon_amt) as allocation_value,current_date as load_date,'gmail' as banner,'tot_dc_frg_aon_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(tot_dc_ocp_aon_amt) as allocation_value,current_date as load_date,'gmail' as banner,'tot_dc_ocp_aon_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(vlm_reb_amt) as allocation_value,current_date as load_date,'gmail' as banner,'vlm_reb_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(vnd_fud_amt) as allocation_value,current_date as load_date,'gmail' as banner,'vnd_fud_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(ocn_frg_amt) as allocation_value,current_date as load_date,'gmail' as banner,'ocn_frg_amt' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\nUNION ALL\nselect fiscal_year,fiscal_month,sum(sos_adj) as allocation_value,current_date as load_date,'gmail' as banner,'sos_adj' as dataset from dpp_canada.lca_src_sales_master group by fiscal_year,fiscal_month\n)a",
    "combined_query":"insert into table dpp_canada.dpp_data_quality_combined partition(load_date,banner)\nselect\nfiscal_year,\nfiscal_month,\nsum(term_perc) as term_perc,\nsum(term_days) as term_days,\nsum(pmt_term_eqvlcy) as pmt_term_eqvlcy,\nsum(sales) as sales,\nsum(unit) as unit,\nsum(margin) as margin,\nsum(dpp) as dpp,\nsum(cogs) as cogs,\nsum(fulfilled_cost) as fulfilled_cost,\nsum(vnd_fud_amt) as vnd_fud_amt,\nsum(tot_clm_aon_amt) as tot_clm_aon_amt,\nsum(pos) as pos,\nsum(web_pos) as web_pos,\nsum(sta) as sta,\nsum(mdf) as mdf,\nsum(national_promo) as national_promo,\nsum(national_web_promo) as national_web_promo,\nsum(lump_sum) as lump_sum,\nsum(avg_invoice_cost) as avg_invoice_cost,\nsum(mst) as mst,\nsum(rtm_defective_allowance) as rtm_defective_allowance,\nsum(delivery_expense) as delivery_expense,\nsum(delivery_revenue) as delivery_revenue,\nsum(est_frg_amt) as est_frg_amt,\nsum(tot_dc_rcv_aon_amt) as tot_dc_rcv_aon_amt,\nsum(tot_dc_shp_aon_amt) as tot_dc_shp_aon_amt,\nsum(tot_dc_frg_aon_amt) as tot_dc_frg_aon_amt,\nsum(tot_dc_ocp_aon_amt) as tot_dc_ocp_aon_amt,\nsum(ocn_frg_amt) as ocn_frg_amt,\nsum(vlm_reb_amt) as vlm_reb_amt,\nsum(total_transactions) as total_transactions,\nsum(dty_amt) as dty_amt,\nsum(sos_adj) as sos_adj,\nsum(shrink) as shrink,\nsum(cash_discounts) as cash_discounts,\nsum(postage) as postage,\nsum(non_vat_acmc) as non_vat_acmc,\nsum(markup) as markup,\nsum(markdown) as markdown,\nsum(vat) as vat,\nsum(merch_margin) as merch_margin,\ncurrent_date as load_date,\nbanner\nfrom dpp_canada.rna_lca_combined_dpp group by\nfiscal_year,\nfiscal_month,\nbanner",
    "hive_agg_query": "'select coalesce(fiscal_year,0) as fiscal_year,coalesce(fiscal_month,0) as fiscal_month,coalesce(allocation_value,0) as allocation_value,rank,load_date,banner,dataset from dpp_canada.dpp_data_quality_agg where load_date in (select distinct load_date from dpp_canada.dpp_data_quality_agg order by load_date desc limit 2)'",
    "hive_combined_query": "'select * from dpp_canada.dpp_data_quality_combined where load_date=(select max(load_date) from dpp_canada.dpp_data_quality_combined)'",
    "csv_agg_path": "/hdptmp/s0998ii3/agg_quality",
    "csv_combined_path": "/hdptmp/s0998ii3/agg_combined",
    "script_path": "/python/spark/spark_generate_csvfile.py",
    "elastic_script_agg": "/python/spark/elastic_data_push_agg.py",
    "elastic_script_combined": "/python/spark/elastic_data_push_combined.py",
    "copy_local_agg": "/home/svcmapprdrw/agg_quality/",
    "copy_local_combined": "/home/svcmapprdrw/agg_combined/"
  }
}
